# КДЗ-2, Порфирьев Антон, БПИ219

## О программе

В этой программе реализовано сравнение 3.5 алгоритмов, далее n - длина строки, m - длина Шаблона:
1. Простый перебор. O(nm)
2. Обычный КМП. O(n + m)
3. Улучшенный КМП. O(n + m)
4. С Использованием Хешей, реализовано только при отсутвии ? в шаблоне. O(n + m) с вероятностью коллизии.

Описывать, как устроены 1-3 не имеет смысла, так как они есть в задании.

### Алгоритм с использованием Хешей

#### Что за Хеши, в данном контексте

Зафиксируем 2 простых числа: $M$ = 1791791791, $p$ = 31.

Пусть $f$ - функция: $['a'-'z'] \to \mathbb{Z}/M\mathbb{Z}$ (Далее это множество будет $K$). Такая что букве соответсвует её порядковый номер в индексации с 0.

$\textbf{Замечание:}$ $f$ - не является сюръекцией

Пусть $S$ - мн-во всех конечных последовательностей из элементов $['a'-'z']$.

Введём функцию $\widetilde{h}$: $S \to K[x]$. Определённую следующим образом:

$\forall s \in S$, по определению $s = c_1,c_2,...,c_n$, где $c_i \in ['a'-'z']$, определим $\widetilde{h}(x) = \sum\limits_{i=1}^n f(c_i)*x^{n-i} \in K[x]$.

Введём функцию $\widetilde{p}$ : $K[x] \to K$, $\forall t(x) \in K[x] \ \widetilde{p}(t(x)) := t(p)$.

$\textbf{Замечание:}$ $p \in K$, поэтому определение функции корректно

И наконец вводим функцию $h$: $S \to K$, $\forall s \in S \ h(s) := \widetilde{p}(\widetilde{h}(s))$

Говоря простым языком мы для каждого слова сопастовляем, остаток по модулю M:

$s \to (c_1*p^{n - 1} + ... + c_n) \mod M$, где $c_i$ - просто номер буквы в алфавите

#### Ну ввели, а что дальше?

Используя [cхему Горнера](https://en.wikipedia.org/wiki/Horner%27s_method), можно за O(n) посчитать $h$ (далее иногда, буду писать Хэш) для каждого префикса данной строки

Также за O(n) - можно посчитать все $p^i \mod M$.

Также имея посчитанные выше объекты, можно легко посчитать $\forall i < j$ Хэш у соотв. подстроки. $h(S[i, ... j-1]) = h(S[1, ...j-1]) - h(S[1, ...i-1]) * p^{j - i}$. Все арифм. действия очевидно выполняются над полем $K$

#### Хорошо можем, И?

Заметим, что так $h$ - функция, то у одинаковых строк значение одинаковое.

Однако она очевидно не инъективна. 

Несмотря на это, мы делаем ключевое замечание (которое я доказывать и формализовывать не буду :), что на различных строках совпадение маловероятно)

Поэтому далее будем считать, что строки совпадают, если у них совпал Хэш.

И далее мы приминяем самый тривиальный алгоритм, только вместо посимвольного сравнения, будем сравнивать Хеши.

### Анализ графиков

На графиках для строк длиной 10000 прктически не видно закономерностей, но графиках до 10000 уже видно, что наивный алгоритм работает хуже.

На графиках для строк длиной 100000, Уже видно разницу, двух алгоритмов КМП. К сожалению, почему-то произошли выбросы обычного КМП, когда нет ? и Хэши видно плохо, но видно, что лучше наивного, но хуже "усечённого" КМП
